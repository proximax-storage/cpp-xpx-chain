node {

    docker.withRegistry('https://249767383774.dkr.ecr.ap-southeast-1.amazonaws.com/proximax-catapult-server', 'ecr:ap-southeast-1:jenkins-ecr') {
        docker.image('catapult-server-build-image').pull()
        
        stage('Build') {
            echo 'Building catapult-server'
            sh 'cat /etc/*release'
        }
    }
    
    stage('Test') {
        echo 'Running unit tests'
    }
    
    stage('Build Docker Image') {
        echo 'Building catapult-server Docker image'
    }
    
    stage('Push Image to Docker Registry') {
        echo 'Pushing catapult-server Docker image to AWS ECR Docker registry'
    }
}
