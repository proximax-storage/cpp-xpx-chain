#!/bin/bash
set -e
set -x

CHAIN_FOLDER="/Users/alex2/Proj/cpp-xpx-chain/"

LIQUIDITY_PROVIDER_SENDER="C06B2CC5D7B66900B2493CF68BE10B7AA8690D973B7F0B65D0DAE4F7AA464716"

CURRENCY_MOSAIC_ID="0DC67FBE1CAD29E3"

REPLICATOR_CAPACITY=20480

api_node_ip="127.0.0.1"

cd $CHAIN_FOLDER
cd ../go-xpx-chain-sdk/tools/transfer

./transfer -url=http://127.0.0.1:3000 \
 -feeStrategy=middle \
 -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
 -receiver=B4F12E7C9F6946091E2CB8B6D3A12B50D17CCBBF646386EA27CE2946A7423DCF \
 -mosaic=0DC67FBE1CAD29E3\
 -amount=10000000000000



cd $CHAIN_FOLDER
../go-xpx-chain-sdk/tools/liquidity_provider/liquidity_provider -url=http://${api_node_info[ip]}:3000 \
    -feeStrategy=middle \
    -sender=$LIQUIDITY_PROVIDER_SENDER \
    -mosaic=storage \
    -initial=100000 \
    -deposit=1000000 \
    -slashingPeriod=500 \
    -ws=5 \
    -a=500 \
    -b=500 \
    -slashingAcc=0000000000000000000000000000000000000000000000000000000000000000 \
    create

../go-xpx-chain-sdk/tools/liquidity_provider/liquidity_provider -url=http://${api_node_info[ip]}:3000 \
    -feeStrategy=middle \
    -sender=$LIQUIDITY_PROVIDER_SENDER \
    -mosaic=streaming \
    -initial=100000 \
    -deposit=1000000 \
    -slashingPeriod=500 \
    -ws=5 \
    -a=500 \
    -b=500 \
    -slashingAcc=0000000000000000000000000000000000000000000000000000000000000000 \
    create

#################################################################################
# Transfer Xpx-s to user accounts
#################################################################################
userAccounts=(
#"0455F5326D5C380115E4BAE4B6EB2CEF4F83C3E5C4517494BFE11F5554135CF7"
#"10AB82ACE20F2DC3EDC5E4C77B09420D60FB707B8D4AA86A768B05CF943A93EB"
#"8A578DC2A5F07B0ADE9DECCD626AE3C3610E72D7033191063C74E1DA9E9D4C09"
#"89B9562B99A810B367783252264192BAFA242429791376CE6FA4DA66B55101C7"
#"46391A7DDD8191643809AE3B71BE9118BDD55EB631E3DC489954A7BB1096A010"
#"1BFA76AC397E7AF9F45EA6498E4DA3B5C1CA26DD6951A4DB41C7600CC328E1B1"
#"762C30C78F0B91B4A4E87AC669158174E3D277A68A9119162DD4FAFE316CAAC2"
#"9A5765FF125DB9741959EE012AFE4BF43E55BA0B7BE5570F1F4F5707D0A734F5"
#"BD3560BC308530ECF5A7BA1F9A10A466F89D09D9932814DD944D52695253D1C4"
#"4824A46F2DC59C537B45E5ECE395A7A58BBDE77741D3479EA8B91E8CCF7D8AFC"
#"8220ADD1FFBE1AC627597D6C0D29442051C80D84921A26522E72262BCDE5E53D"
"29C27BE2C64BCCC8DDA934F8F4092CDF418CC160AF60D50EF74B263E6A5E9E41"
"C088AD3995E632CCC7C46892C700A36A04606102DA42E5E8593405883AD52BA3"
"476773CBF109ADD4D9F377838C3722CC20FEDCB4F6866972F0D3E66444BFDF0B"
"DA5C901FA2AC112806EF0F06935D0A62A9A721CEECB10A3FD1C986DC36159E73"
"FA04036C14B76B01FAC19F6522C487509691FC5566B7CD95BC0B2207A3F3D162"
"F9580B8C5A2D68E946974DFC99A470147BB03470A3F1E415051A56B186723579"
)

cd $CHAIN_FOLDER
cd ../go-xpx-chain-sdk/tools/transfer

for userKey in "${userAccounts[@]}"
do
    ./transfer \
        -url=http://$api_node_ip:3000 \
        -feeStrategy=middle \
        -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
        -receiver="$userKey" \
        -mosaic=$CURRENCY_MOSAIC_ID \
        -amount=1000000000
done

#################################################################################
# Transfer Xpx-s to replicators
#################################################################################

./transfer -url=http://127.0.0.1:3000 \
 -feeStrategy=middle \
 -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
 -receiver=E8D4B7BEB2A531ECA8CC7FD93F79A4C828C24BE33F99CF7C5609FF5CE14605F4 \
 -mosaic=0DC67FBE1CAD29E3\
 -amount=10000000000000

./transfer -url=http://127.0.0.1:3000 \
 -feeStrategy=middle \
 -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
 -receiver=7C756F2D5E9F21E7215851FC26C9F6819DB7992F0CDD22D822AFBE764404E976 \
 -mosaic=0DC67FBE1CAD29E3\
 -amount=10000000000000

 ./transfer -url=http://127.0.0.1:3000 \
 -feeStrategy=middle \
 -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
 -receiver=0A0EAC0E56FE4C052B66D070434621E74793FBF1D6F45286897240681A668BB1 \
 -mosaic=0DC67FBE1CAD29E3\
 -amount=10000000000000

 ./transfer -url=http://127.0.0.1:3000 \
 -feeStrategy=middle \
 -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
 -receiver=1AAD933111E340E74FE9A44C12CEB359744BC9F8A6630ECA7DEA8B5AECE5C1C5 \
 -mosaic=0DC67FBE1CAD29E3\
 -amount=10000000000000

 ./transfer -url=http://127.0.0.1:3000 \
 -feeStrategy=middle \
 -sender=819F72066B17FFD71B8B4142C5AEAE4B997B0882ABDF2C263B02869382BD93A0 \
 -receiver=71FA42E336DE2DD74CE864A7A5A747C23EAB41BC6235CBA4C28E96B1900565FC \
 -mosaic=0DC67FBE1CAD29E3\
 -amount=10000000000000

#################################################################################
# Onboard replicators
#################################################################################
cd $CHAIN_FOLDER
../go-xpx-chain-sdk/tools/replicator_onboarding

./replicator_onboarding -url=http://127.0.0.1:3000 \
-feeStrategy=middle \
-capacity=2048 \
-replicatorPrivateKey=2F985E4EC55D60C957C973BD1BEE2C0B3BA313A841D3EE4C74810805E6936053 \
-nodeBootPrivateKey=2F985E4EC55D60C957C973BD1BEE2C0B3BA313A841D3EE4C74810805E6936053

./replicator_onboarding -url=http://127.0.0.1:3000 \
-feeStrategy=middle \
-capacity=2048 \
-replicatorPrivateKey=415ABF3AA04493587AD0B3C6B594F369F74F4055CFBD2BF028AE29EA3C1C6BD3 \
-nodeBootPrivateKey=415ABF3AA04493587AD0B3C6B594F369F74F4055CFBD2BF028AE29EA3C1C6BD3

./replicator_onboarding -url=http://127.0.0.1:3000 \
-feeStrategy=middle \
-capacity=2048 \
-replicatorPrivateKey=48AD5278466BC0D765299AFD1A43D7EA7C3463A8078A54ACCD505D0FACA6B62F \
-nodeBootPrivateKey=48AD5278466BC0D765299AFD1A43D7EA7C3463A8078A54ACCD505D0FACA6B62F

./replicator_onboarding -url=http://127.0.0.1:3000 \
-feeStrategy=middle \
-capacity=2048 \
-replicatorPrivateKey=7BF479B4D79F5752E6BCCE859D2D4731D898A9B16E90E6D479DF13CE15B8CD42 \
-nodeBootPrivateKey=7BF479B4D79F5752E6BCCE859D2D4731D898A9B16E90E6D479DF13CE15B8CD42

./replicator_onboarding -url=http://127.0.0.1:3000 \
-feeStrategy=middle \
-capacity=2048 \
-replicatorPrivateKey=FB83889FB84E6D0596C046C27A1A151395666AF79AFB72DBF5B15161040F05E1 \
-nodeBootPrivateKey=FB83889FB84E6D0596C046C27A1A151395666AF79AFB72DBF5B15161040F05E1
